#!/bin/bash
# Decrease keyboard backlight brightness

# Auto-detect keyboard backlight path
if [ -e /sys/class/leds/apple::kbd_backlight/brightness ]; then
  CURRENT=$(cat /sys/class/leds/apple::kbd_backlight/brightness)
  MAX=$(cat /sys/class/leds/apple::kbd_backlight/max_brightness)
  STEP=$((MAX / 10))  # 10% steps
  NEW=$((CURRENT - STEP))
  if (( NEW < 0 )); then
    NEW=0
  fi
  echo "$NEW" | sudo tee /sys/class/leds/apple::kbd_backlight/brightness > /dev/null
elif [ -e /sys/class/leds/dell::kbd_backlight/brightness ]; then
  CURRENT=$(cat /sys/class/leds/dell::kbd_backlight/brightness)
  NEW=$((CURRENT - 1))
  if (( NEW < 0 )); then
    NEW=0
  fi
  echo "$NEW" | sudo tee /sys/class/leds/dell::kbd_backlight/brightness > /dev/null
fi
